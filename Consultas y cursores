/*
*
*   CONSULTAS
*   Y
*   CURSORES
*
*/

SET SERVEROUTPUT ON

--RF-001 (REPARTOS CADA MES POR REPARTIDOR)
SELECT DNI,NOMBRE,NUM_REPARTOS FROM
(SELECT DNI_REPARTIDOR AS DNI,COUNT(*) AS NUM_REPARTOS FROM REPARTOS
WHERE EXTRACT(MONTH FROM HORAINICIO)=EXTRACT(MONTH FROM (SELECT SYSDATE FROM DUAL))
GROUP BY DNI_REPARTIDOR)
NATURAL JOIN REPARTIDORES;

--RF-002 (PEDIDOS CADA DIA)
SELECT EXTRACT(DAY FROM FECHA) AS DIA,EXTRACT(MONTH FROM FECHA) AS MES,EXTRACT(YEAR FROM FECHA) AS ANO,COUNT(*) AS NUM_PEDIDOS FROM PEDIDOS
GROUP BY (EXTRACT(DAY FROM FECHA),EXTRACT(MONTH FROM FECHA),EXTRACT(YEAR FROM FECHA))
ORDER BY ANO DESC, MES DESC, DIA;

--RI-003 (ENCARGOS EN ESTE MES MES)
SELECT * FROM ENCARGOS
WHERE EXTRACT(MONTH FROM FECHA)=EXTRACT(MONTH FROM (SELECT SYSDATE FROM DUAL));

--RI-004 (EMPLEADOS)
SELECT DNI,NOMBRE,SUELDO FROM ((SELECT * FROM COCINEROS) UNION ((SELECT * FROM REPARTIDORES) UNION (SELECT * FROM ORDERTAKERS)));

--RI-003 (TICKET)
EXEC IMPRIMETICKET(1);

--RI-006 (CARTA)
EXEC IMPRIMECARTA;
